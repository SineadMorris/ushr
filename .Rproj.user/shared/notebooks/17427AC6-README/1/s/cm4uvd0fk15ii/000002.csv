"0","# 1. Estimate parameters and 95% CIs by fitting linear model"
"0","getparams <- function(data){"
"0","    lmfit <- lm(log(Trm + 1) ~ day, data = data)"
"0","    "
"0","    netloss <- - coef(lmfit)[2]"
"0","    "
"0","    return( data.frame(netloss = netloss, halflife = log(2)/netloss) )"
"0","}"
"0","# 2 Test for normal residuals from fitted linear model"
"0","testresids <- function(data){"
"0","    lmfit <- lm(log(Trm + 1) ~ day, data = data)"
"0","    "
"0","    pval <- shapiro.test(lmfit$residuals)$p.value"
"0","    "
"0","    return(data.frame(pval = pval) )"
"0","}"
"0","# 3. Get predictions from fitted linear model"
"0","getpredictions <- function(data, xnew){"
"0","    lmfit <- lm(log(Trm + 1) ~ day, data = data)"
"0","    "
"0","    predictions <- data.frame(day = xnew, Trm = predict(lmfit, xnew, interval = ""confidence"")) %>% "
"0","        mutate(Trm = exp(Trm.fit) - 1, upper = exp(Trm.upr) - 1, lower = exp(Trm.lwr) - 1)"
"0","    "
"0","    return(predictions)"
"0","}"
